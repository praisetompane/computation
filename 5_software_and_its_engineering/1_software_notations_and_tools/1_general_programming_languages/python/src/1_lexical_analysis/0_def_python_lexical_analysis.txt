Python programs are read by a parser
    the parsers accepts a stream of tokens as input (Python Software Foundation, 2023).

Lexical analyzer: generates stream of tokens from Python program text (Python Software Foundation, 2023).
Python Lexical Analysis (Python Software Foundation, 2023):
    Line structure:
        Python programs are divided into logical lines.    
            defs:
                - logical line:
                    denoted by NEWLINE(\n) token.
                    constructed from one or more physical lines
                        following explicit and implicit line joining rules.
                    statements do not cross logical lines.
                        exceptions = {if the statement's syntax allows NEWLINEs}
                            e.g. compound statement: if..else

                - physical line:
                    -denoted by end-of-line sequence.
                        - supported sequences:
                            LF = Line Feed
                            CR = Carriage Return
                            CRLF = Carriage Return Line Feed
                    implicitly denoted by end of input.

                - blank lines:
                    logical
                        contains spaces, tabs, formfeeds and possibly a comment:
                            is ignored (i.e. does not generate NEWLINE token).

                        in read-eval-print loop (REPL): 
                            entirely blank logical line(i.e. contains nothing) 
                                terminates a multi-line statement [in CPython].

                - explicit line joining:
                    join two or more physical lines
                        into one logical line
                        with '\'.

                    the interpreter remove the '\' and end-of-line character.
                    
                    '\' properties:
                        - must be outside string or comment to work.
                        - line ending with it, cannot have a comment.
                        - can only be used to split string literals
                            across physical lines.
                            example:
                                if I wanted to set 'number' with value 342452423442245323234234342343432342
                                    but its too long in the editor:
                                    NB: I cannot split it, the statement below is illegal:
                                        number = 342452423442245323234234 \
                                                    342343432342 
                                    
                        - illegal elsewhere on logical lines
                            except string literals. 
                            
                - implicit line joining:
                    join row or more physical lines
                        into one logical line
                        with '[]', '{}', '()' or '""" """'

                    properties:
                        - comments allowed at the end
                            - comment disallowed for '""" """'
                        - does not require explicit '\'
                        - blank line continuations are allowed
                        - indentation between continuation lines is not enforced
                        - does not generate NEWLINE token.
                - indentation:
                    - leading white space(tabs or spaces)
                        at beginning of a logical line
                            is used to calculate indentation level
                                of the line.

                        - the indentation level is used to calculate grouping of statements.
                    
                        example:
                            valid code:
                                def test():
                                            print("1")
                                NB: notice print is 3 tabs indented.
                                        you can indent the first statement arbitrarily deep.

                            invalid code:
                                def test():
                                            print("1")
                                        print("2)
                                NB: The first line "print("1")" is used to calculate indentation level at 3 tabs.
                                        print("2") is less than that, hence it fails with IndentationError.
                    - properties:
                        - total spaces preceding
                            first non-blank character determine's the line indentation.
                        - cannot be split across physical lines with '\'.
                        - white space preceding first '\' terminates indentation
                        - invalid if contains inconsistent use of tabs and spaces.
                            raises TabError
                            def TabError: https://docs.python.org/3.11/library/exceptions.html#TabError
                    - formfeed character
                        - if first character in the line:
                            - ignored for indentation calculations
                        - if found else where in the leading whitespace
                            - has undefined effect
                                - may reset space count to zero.
                    - algorithm:
                        def: indentation levels
                            of consecutive lines
                            are used to generate
                                INDENT and DETENT tokens

                        data structure: stack
                            - stack invariant = numbers in increasing order.
                        flow:
                            - push zero onto stack.
                            - for all lines:
                                calculate line_indentation_level
                                if line_indentation_level == stack_top_value, then
                                    do nothing
                                if line_indentation_level > stack_top_value, then
                                    add line_indentation_level to stack
                                    generate INDENT token
                                else #line_indentation_level < stack_top_value, then
                                    line_indentation_level MUST be on stack
                                    for all stack_values 
                                        if stack_value > line_indentation_level, then
                                            pop off
                                            generate DETENT token
                                    for all stack values #remaining ones
                                        if stack_value > 0
                                            generate DETENT token
                
                - comments:
                    - starts at beginning of logical line with a hash character(#).
                        the # must NOT be part of string literal.
                    - finishes at the end of physical.
                    - signify end of logical line
                        unless implicit line joining rules are invoked.
                    - ignored by the syntax.
                
                - encoding declarations:
                    - informs Python the encoding scheme of the file.
                    - properties:
                        - must be in the first two lines.
                        - if second of the two, the preceding MUST be a comment.
                        - provided encoding must be Python supported:
                            supported list: https://docs.python.org/3.11/library/codecs.html#standard-encodings
                        - declaration must match this regex: coding[=:]\s*([-\w.]+)
                        - defaults to UTF-8
                    - the encoding is used for all lexical analysis.
                    - recommended:
                        # -*- coding: <encoding-name> -*-

                - white spaces between tokens:
                    tab, space, formfeeds are interchangeable for separating tokens
                        exceptions: 
                            - beginning of logical line
                            - string literal
                                i.e. value \tab value ≠ value \space value
                                    praise  is coming   ≠ praise is coming

References:
    Python Software Foundation. 2023. Lexical analysis. https://docs.python.org/3.11/reference/lexical_analysis.html#.